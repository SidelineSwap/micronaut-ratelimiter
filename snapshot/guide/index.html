<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>Micronaut RateLimiter</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/custom.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <link rel="stylesheet" href="../css/highlight/agate.css">
    <script src="../js/highlight.pack.js"></script>
    <script src="../js/guide.js"></script>
    <script src="../js/multi-language-sample.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="stylesheet" href="../css/multi-language-sample.css"/>
    <script src="../js/docs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.13/clipboard.min.js"></script>
    <script type="text/javascript">
        function addJsClass(el) {
            var classes = document.body.className.split(" ");
            classes.push("js");
            document.body.className = classes.join(" ");
        }
    </script>

</head>

<body class="body" id="docs" onload="addJsClass();" onhashchange="highlightMenu()">

<div id="table-of-content-nav-link" class="desktop">
    <a id="theme-switcher" title="Switch to dark theme" href="javascript:switchTheme(true)"><i class="fa fa-moon-o"></i></a>
    <a title="Collapse/Open Table of contents" title="Hide Table of Contents" href="javascript:hideTableOfContents();" class="button">[ + ]</a>
</div>

<div id="main">
    <div id="navigation" class="no-print">
        <div class="navTitle">
            <span id="logo"><a href="http://micronaut.io" title="Go to Micronaut Website"><img src="../img/micronaut-logo-white.svg" alt="Micronaut"/></a></span>
        </div>
        <div class="navLinks">
            <ul>
                    <li><div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)" class="desktop">
                            <a href="../guide/index.html" class="button">Table of contents</a>
                            <div id="nav-summary-childs" style="display:none;">
                                
                                <div class="toc-item" style="margin-left:0"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#installation"><strong>2</strong><span>Installation</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#configuration"><strong>3</strong><span>Configuration</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#gettingstarted"><strong>4</strong><span>Getting Started</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#usage"><strong>5</strong><span>Usage</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#resilience4j"><strong>6</strong><span>Resilience4j</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#repository"><strong>7</strong><span>Repository</span></a></div>
                                
                            </div>
                        </div>
                    </li>

                <li id="table-of-content-nav-link-mobile" class="mobile">
                    <a title="Scroll to Table of contents" href="javascript:scrollToTop();" class="button">Toc</a>
                </li>
                <li class="desktop">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API</a>
                </li>
                <li class="desktop">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Configuration Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Conf</a>
                </li>
            </ul>

        </div>
    </div>
    
    <div id="table-of-content">
        <div class="toc-content">

        <h2>Table of Contents</h2>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-introduction"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-installation"><a href="#installation"><strong>2</strong><span>Installation</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-configuration"><a href="#configuration"><strong>3</strong><span>Configuration</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-gettingstarted"><a href="#gettingstarted"><strong>4</strong><span>Getting Started</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-usage"><a href="#usage"><strong>5</strong><span>Usage</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-resilience4j"><a href="#resilience4j"><strong>6</strong><span>Resilience4j</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-resilience4j-configuration"><a href="#resilience4j-configuration"><strong>6.1</strong><span>Configuration</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-resilience4j-response"><a href="#resilience4j-response"><strong>6.2</strong><span>Error Response</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-repository"><a href="#repository"><strong>7</strong><span>Repository</span></a></div>
        
        </div>
    </div>
    
    <div class="docs-content">
    <div class="project">
        <h1>Micronaut RateLimiter</h1>
        <p></p>
        <p>Rate limiting support for Micronaut</p>
        <p><strong>Version:</strong> <select style='max-width: 200px' onChange='window.document.location.href=this.options[this.selectedIndex].value;'><option selected='selected' value='https://micronaut-projects.github.io/micronaut-ratelimiter/snapshot/guide/index.html'>1.0.0.BUILD-SNAPSHOT</option></select></p>
    </div>
    
<h1 id="introduction"><a class="anchor" href="#introduction"></a>1 Introduction</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-ratelimiter/edit/master/src/main/docs/guide/introduction.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>This project brings rate limiting support to Micronaut. The core module contains the common functionality and configuration. An implementation is required to have any rate limiting functionality.</p>
</div>
<div class="paragraph">
<p>To get started, you need to declare a dependency on one of the implementations. See the next section on installation.</p>
</div>
<div class="paragraph">
<p>To use a snapshot version of this library, check the
<a href="https://docs.micronaut.io/latest/guide/index.html#usingsnapshots">documentation to use snapshots</a>.</p>
</div>

<h1 id="installation"><a class="anchor" href="#installation"></a>2 Installation</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-ratelimiter/edit/master/src/main/docs/guide/installation.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To start using rate limiters in Micronaut, simply express a dependency on one of the implementations that are available. See the documentation for your desired implementation for details.</p>
</div>

<h1 id="configuration"><a class="anchor" href="#configuration"></a>3 Configuration</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-ratelimiter/edit/master/src/main/docs/guide/configuration.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The core library provides configuration that applies to every implementation. By default when an implementation is on the classpath and enabled, rate limiting will apply to all APIs. You can limit the functionality to a subset of your controllers and methods through the following configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">micronaut:
  ratelimiting:
    paths: <i class="conum" data-value="1"></i><b>(1)</b>
      - /api/**</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>One or more Ant style paths can be supplied to denote what parts of your application should be rate limited.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The presence of the <a href="../api/io/micronaut/ratelimiter/annotation/RateLimit.html">@RateLimit</a> annotation does not automatically allow an API to be being rate limited. All APIs must be in one of the paths supplied via configuration.
</td>
</tr>
</table>
</div>

<h1 id="gettingstarted"><a class="anchor" href="#gettingstarted"></a>4 Getting Started</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-ratelimiter/edit/master/src/main/docs/guide/gettingstarted.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Before you can get started controlling rate limits, there is one concept to understand and potentially an implementation to write. Rate limits are typically broken up into groups or "buckets". For example a rate limit may apply per user, or per organization, etc. There is no clear common default way of grouping the users of an API so that implementation is up to you. An interface <a href="../api/io/micronaut/ratelimiter/bucket/BucketNameResolver.html">BucketNameResolver</a> is used to allow for custom bucket name resolution logic.</p>
</div>
<div class="paragraph">
<p>We have provided a simple implementation that rate limits by IP address. That implementation is disabled by default. To turn it on, set <code>micronaut.ratelimiting.ip-address-resolver: true</code> in your configuration. This implementation is mostly to make getting started with rate limiting easier.</p>
</div>
<div class="paragraph">
<p>Once an implementation of <a href="../api/io/micronaut/ratelimiter/bucket/BucketNameResolver.html">BucketNameResolver</a>, by default all requests will be rate limited using the defaults set by the rate limiting implementation.</p>
</div>

<h1 id="usage"><a class="anchor" href="#usage"></a>5 Usage</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-ratelimiter/edit/master/src/main/docs/guide/usage.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Rate limiting will apply to any paths that have been configured (by default all paths). You can control the rate limiter configuration for any given controller or method as well as exclude any controller or method from being rate limited.</p>
</div>
<div class="sect1">
<h2 id="_rate_limit_configurations">Rate Limit Configurations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each implementation will provide a way to supply rate limiting configurations. To use a given configuration for a section of your API, simply add the <a href="../api/io/micronaut/ratelimiter/annotation/RateLimit.html">@RateLimit</a> annotation to the controller or method and supply the configuration name. For example:</p>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package example;

import io.micronaut.http.HttpResponse;
import io.micronaut.http.annotation.Controller;
import io.micronaut.ratelimiter.annotation.NoRateLimit;
import io.micronaut.ratelimiter.annotation.RateLimit;

@RateLimit("high") <b class="conum">(1)</b>
@Controller("/api") <b class="conum">(2)</b>
public class RateLimitController {

    @NoRateLimit <b class="conum">(3)</b>
    HttpResponse&lt;?&gt; someMethod() {
        return HttpResponse.ok();
    }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">package example

import io.micronaut.http.HttpResponse
import io.micronaut.http.annotation.Controller
import io.micronaut.ratelimiter.annotation.NoRateLimit
import io.micronaut.ratelimiter.annotation.RateLimit

@RateLimit("high") <b class="conum">(1)</b>
@Controller("/api") <b class="conum">(2)</b>
class RateLimitController {

    @NoRateLimit <b class="conum">(3)</b>
    HttpResponse&lt;?&gt; someMethod() {
        HttpResponse.ok()
    }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">package example

import io.micronaut.http.HttpResponse
import io.micronaut.http.annotation.Controller
import io.micronaut.ratelimiter.annotation.NoRateLimit
import io.micronaut.ratelimiter.annotation.RateLimit

@RateLimit("high") <b class="conum">(1)</b>
@Controller("/api") <b class="conum">(2)</b>
class RateLimitController {

    @NoRateLimit <b class="conum">(3)</b>
    fun someMethod() = HttpResponse.ok&lt;Any&gt;()
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The annotation is controlling which configuration will apply to this controller. The annotation can also be applied to individual methods for finer control</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The controllers path matches one of the configured paths</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <a href="../api/io/micronaut/:ratelimiter/annotation/NoRateLimit.html">@NoRateLimit</a> annotation is being used to denote this controller should not be rate limited, even though its path does match one of the configured paths</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <a href="../api/io/micronaut/:ratelimiter/annotation/NoRateLimit.html">@NoRateLimit</a> can also be used at the controller level:</p>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package example;

import io.micronaut.http.annotation.Controller;
import io.micronaut.ratelimiter.annotation.NoRateLimit;

@NoRateLimit
@Controller("/api")
public class NoRateLimitController {
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">package example

import io.micronaut.http.annotation.Controller
import io.micronaut.ratelimiter.annotation.NoRateLimit

@NoRateLimit
@Controller("/api")
class NoRateLimitController {
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">package example

import io.micronaut.http.annotation.Controller
import io.micronaut.ratelimiter.annotation.NoRateLimit

@NoRateLimit
@Controller("/api")
class NoRateLimitController {
}</code></pre>
</div>
</div>
</div>
</div>

<h1 id="resilience4j"><a class="anchor" href="#resilience4j"></a>6 Resilience4j</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-ratelimiter/edit/master/src/main/docs/guide/resilience4j.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>An implementation of rate limiting for Micronaut has been created using Resilience4j.</p>
</div>
<div class="paragraph">
<p>To get started, simply express a dependency on this module:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">runtime(<span class="hljs-string">"io.micronaut.ratelimiter:micronaut-ratelimiter-resilience4j")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.ratelimiter&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-ratelimiter-resilience4j&lt;/artifactId&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</p>
</div>

<h2 id="resilience4j-configuration"><a class="anchor" href="#resilience4j-configuration"></a>6.1 Configuration</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-ratelimiter/edit/master/src/main/docs/guide/resilience4j/resilience4j-configuration.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Resilience4j only has support for a limited number of options, and those options are configurable through Micronaut configuration. Each grouping of options is referred to as a "configuration" and those configurations can be referenced in your code through the <a href="../api/io/micronaut/ratelimiter/annotation/RateLimiter.html">@RateLimiter</a> annotation.</p>
</div>
<div class="paragraph">
<p>If the annotation is missing, then the default configuration will be applied. The default configuration can be supplied through the special name of "default" in your configuration. If that is missing then the defaults provided by the Resilience4j library will be used. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">resilience4j:
  ratelimiter:
    configurations:
      default: <i class="conum" data-value="1"></i><b>(1)</b>
        timeout: 100ms
      low: <i class="conum" data-value="2"></i><b>(2)</b>
        period: 10s
        limit: 1
      high: <i class="conum" data-value="3"></i><b>(3)</b>
        period: 1s
        limit: 100</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The default configuration that will be used if no configuration is set via the annotation. Note that the missing values will inherit the defaults from Resilience4j.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A configuration called "low". This configuration only allows a single request every 10 seconds.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>A configuration called "high". This configuration allows for 100 requests every second.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The "low" and "high" configurations do not inherit from the default. The default configuration only applies when there is no specified configuration for a rate limited API.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For a full reference of the resilience4j options, see the See <a href="configurationreference.html">configuration reference</a>.</p>
</div>

<h2 id="resilience4j-response"><a class="anchor" href="#resilience4j-response"></a>6.2 Error Response</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-ratelimiter/edit/master/src/main/docs/guide/resilience4j/resilience4j-response.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>When the Resilience4j rate limiter rejects a request, a <code>RequestNotPermitted</code> exception will be emitted. This exception can be handled just like any other in Micronaut and a default implementation of <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/server/exceptions/ExceptionHandler.html">ExceptionHandler</a> comes with this library to turn the exception into the standard 429 response.</p>
</div>
<div class="paragraph">
<p>If the default implementation is not sufficient, you may override it by replacing <a href="../api/io/micronaut/ratelimiter/resilience4j/response/RequestNotPermittedHandler.html">RequestNotPermittedHandler</a> with your own implementation.</p>
</div>

<h1 id="repository"><a class="anchor" href="#repository"></a>7 Repository</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-ratelimiter/edit/master/src/main/docs/guide/repository.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can find the source code of this project in this repository:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/micronaut-projects/micronaut-ratelimiter">https://github.com/micronaut-projects/micronaut-ratelimiter</a></p>
</div>

    </div>
</div>

<script type="text/javascript">

</script>
</body>
</html>